
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Intersubject Correlation (ISC) Analysis &#8212; PSYC60 Lab Exercises (F24)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2_ISC';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. ISC Analysis of Functional Connectivity" href="3_functional_connectivity.html" />
    <link rel="prev" title="1. Data Visualization" href="1_data_visualization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_psyc60.png" class="logo__image only-light" alt="PSYC60 Lab Exercises (F24) - Home"/>
    <script>document.write(`<img src="_static/logo_psyc60.png" class="logo__image only-dark" alt="PSYC60 Lab Exercises (F24) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    PSYC60 Lab Exercise
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_data_visualization.html"><strong>1. Data Visualization</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>2. Intersubject Correlation (ISC) Analysis</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="3_functional_connectivity.html"><strong>3. ISC Analysis of Functional Connectivity</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="4_simple_contrasts.html"><strong>4. Simple Contrasts for Localizer Data</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="5_RSA_localizer.html"><strong>5. Representational Similarity Analysis (RSA)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="6_RSA_movie.html"><strong>6. ISC of Representational Geometry</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eunhyechoe/psyc60" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eunhyechoe/psyc60/issues/new?title=Issue%20on%20page%20%2F2_ISC.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/2_ISC.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2. Intersubject Correlation (ISC) Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-environment-import-libraries-and-load-searchlight-indices">1. Setup environment, import libraries, and load searchlight indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-a-multi-subject-dataset">2. Load a multi-subject dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-isc-for-all-vertices-all-individual-pairs">3. Calculate ISC for all vertices, all individual pairs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset">(1) Load dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mean-isc-across-pairs">(2) Calculate mean ISC across pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-brain-image-of-iscs">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs-for-searchlight-all-individual-pairs">4. Calculate ISCs for searchlight, all individual pairs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-searchlight-means">(1) Calculate searchlight means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs">(2) Calculate ISCs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-multisubject-dataset">5. Compare multisubject dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-brain-activity-between-subjects-across-timeseries">(1) Compare brain activity between subjects across timeseries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-brain-activity-within-searchlight-between-subjects">(2) Compare brain activity within searchlight between subjects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-for-assignment-2-s-challenge">ðŸ’¡ Tip for Assignment 2â€™s Challenge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs-for-all-vertices-individuals-vs-others-means">6. Calculate ISCs for all vertices, individuals vs others means</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-the-means-of-others">(1) Generate the means of others</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mean-iscs-across-pairs">(2) Calculate mean ISCs across pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-differences-between-iscs">7. Calculate differences between ISCs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-individual-pairs-individual-vs-others-mean-pairs">(1) All individual pairs - Individual vs others mean pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-vertices-searchlight">(2) All vertices - Searchlight</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/eunhyechoe/psyc60/blob/main/2_ISC.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="intersubject-correlation-isc-analysis">
<h1><strong>2. Intersubject Correlation (ISC) Analysis</strong><a class="headerlink" href="#intersubject-correlation-isc-analysis" title="Link to this heading">#</a></h1>
<p><em>Lastly Updated: Oct 15 (04:05 PM)</em></p>
<section id="setup-environment-import-libraries-and-load-searchlight-indices">
<h2>1. Setup environment, import libraries, and load searchlight indices<a class="headerlink" href="#setup-environment-import-libraries-and-load-searchlight-indices" title="Link to this heading">#</a></h2>
<p>As mentioned in the previous tutorial, Colab refreshes its environment each time, so we need to prepare for data analysis again. Just like last time, letâ€™s install several packages, including <code class="docutils literal notranslate"><span class="pre">neuroboros</span></code>, and load the necessary libraries and searchlight indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 1</span>
<span class="c1"># start and install neuroboros</span>
<span class="o">%%capture</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">neuroboros</span> <span class="n">hyperalignment</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%capture` not found.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 2</span>
<span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">neuroboros</span> <span class="k">as</span> <span class="nn">nb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">cdist</span><span class="p">,</span> <span class="n">squareform</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 3</span>
<span class="c1"># load searchlight indices for ico8 right hemisphere (607 searchlights, 9666 vertices)</span>
<span class="c1">## rh, radii = 10 mm, 15, and 20 mm</span>
<span class="n">SLS_ico8_10mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SLS_ico8_15mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SLS_ico8_20mm_rh</span><span class="p">,</span> <span class="n">Dists_ico8_20mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># sls function input variables: (&#39;hemisphere&#39;, radius, vertex space, center space, option to load file of distances from center to each vertex)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-a-multi-subject-dataset">
<h2>2. Load a multi-subject dataset<a class="headerlink" href="#load-a-multi-subject-dataset" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will perform an intersubject correlation analysis using data from multiple participants. As we practiced last time, letâ€™s use the <code class="docutils literal notranslate"><span class="pre">forrest</span></code> dataset provided by <code class="docutils literal notranslate"><span class="pre">neuroboros</span></code> to load a multiple-subject dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define data first</span>
<span class="n">dset</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">Forrest</span><span class="p">()</span>
<span class="n">sids</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">subjects</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sids</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;01&#39;,
 &#39;02&#39;,
 &#39;03&#39;,
 &#39;04&#39;,
 &#39;05&#39;,
 &#39;06&#39;,
 &#39;09&#39;,
 &#39;10&#39;,
 &#39;14&#39;,
 &#39;15&#39;,
 &#39;16&#39;,
 &#39;17&#39;,
 &#39;18&#39;,
 &#39;19&#39;,
 &#39;20&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 1</span>
<span class="c1"># upload multisubject data (five brains, right hemisphere for first run)</span>
<span class="c1"># dm5 is a data matrix with brains, timepoints, and vertices as dimensions [5,451,9666]</span>
<span class="c1">#dm5 = np.zeros((5,451,9666))</span>
<span class="c1">#for subj in range(5):</span>
<span class="c1">#  sid = sids[subj]</span>
<span class="c1">#  dm5[subj,:,:] = dset.get_data(sid, &#39;forrest&#39;, 1, &#39;r&#39;)</span>
<span class="c1"># (subject id, &#39;dataset&#39;, run, &#39;hemisphere&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>Since loading the entire dataset (i.e. <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">subj</span> <span class="pre">in</span> <span class="pre">range(20)</span></code>) would take too much time, we will practice using data from just three participants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">451</span><span class="p">,</span><span class="mi">9666</span><span class="p">))</span>
<span class="k">for</span> <span class="n">subj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
 <span class="n">sid</span> <span class="o">=</span> <span class="n">sids</span><span class="p">[</span><span class="n">subj</span><span class="p">]</span>
 <span class="n">dm</span><span class="p">[</span><span class="n">subj</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s1">&#39;forrest&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-isc-for-all-vertices-all-individual-pairs">
<h2>3. Calculate ISC for all vertices, all individual pairs<a class="headerlink" href="#calculate-isc-for-all-vertices-all-individual-pairs" title="Link to this heading">#</a></h2>
<section id="load-dataset">
<h3>(1) Load dataset<a class="headerlink" href="#load-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 451, 9666)
</pre></div>
</div>
</div>
</div>
<p>The multisubject data matrix weâ€™ve loaded has a structure of <code class="docutils literal notranslate"><span class="pre">[subject,</span> <span class="pre">timepoint,</span> <span class="pre">vertices]</span></code>. We will calculate the intersubject correlation coefficient for each of the 9666 vertices that make up the data points of the right hemisphere. Letâ€™s see if we can observe significant intersubject correlation for specific vertex across time.</p>
<p>Since we need to repeat the calculation for all vertices, we will use a <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">vertex</span> <span class="pre">in</span> <span class="pre">range(9666)</span></code> loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 2 copy</span>
<span class="c1"># calculate ISC pairwise</span>
<span class="n">ISCs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9666</span><span class="p">))</span>
<span class="k">for</span> <span class="n">vtx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9666</span><span class="p">):</span>
  <span class="n">ISCs</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">vtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dm</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">vtx</span><span class="p">])</span>
  <span class="n">ISCs_clean</span> <span class="o">=</span> <span class="n">ISCs</span> <span class="c1"># copy ISCs to make a clean version</span>
  <span class="n">ISCs_clean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ISCs</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># clean up not-a-number cells</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/usr/local/lib/python3.10/dist-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
</pre></div>
</div>
</div>
</div>
<p>Therefore, each vertex will have 3x3 correlation matrix for three participants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ISCs_clean</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 3, 9666)
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-mean-isc-across-pairs">
<h3>(2) Calculate mean ISC across pairs<a class="headerlink" href="#calculate-mean-isc-across-pairs" title="Link to this heading">#</a></h3>
<p>Now, letâ€™s calculate mean of intersubject correlation, across all possible pairs (of subjects). Since you have a 3x3 matrix for each vertex, you need to exclude the 3 diagonal elements (self-correlations) and calculate the average of the 6 off-diagonal elements (pairwise correlations between the 3 subjects).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 2</span>
<span class="c1">## calculate mean ISCs to show brain map</span>
<span class="n">ISCs_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ISCs_clean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max ISC =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ISCs_mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max ISC = 0.6529441046341343
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-brain-image-of-iscs">
<h3>(3) Plot brain image of ISCs<a class="headerlink" href="#plot-brain-image-of-iscs" title="Link to this heading">#</a></h3>
<p>You can plot ISCs as brain images. Donâ€™t forget to set the maximum ISC value as the plotâ€™s maximum value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 3</span>
<span class="c1">## plot mean pairwise ISCs</span>
<span class="n">lh_minus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9675</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">ISCs_mean</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean pairwise ISC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/086ac201c6f6de90f5d3d5d42de01224155c8963fc1588b435f632d98d8999e5.png" src="_images/086ac201c6f6de90f5d3d5d42de01224155c8963fc1588b435f632d98d8999e5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot positive values only</span>
<span class="n">lh_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9675</span><span class="p">))</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_zero</span><span class="p">,</span> <span class="n">ISCs_mean</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ISCs_mean</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean pairwise ISC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d5f875f603795059df5c8db6a94e1d970d5c36126d14fcf58a2a4d8a8402b65e.png" src="_images/d5f875f603795059df5c8db6a94e1d970d5c36126d14fcf58a2a4d8a8402b65e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Part II, ISC, cell 2 alternate</span>
<span class="c1"># # calculate ISC pairwise</span>
<span class="c1"># ISCs = np.zeros[5,5,9666]</span>
<span class="c1"># for subj in range(5):</span>
<span class="c1">#   for subj in range(5):</span>
<span class="c1">#     for vtx in range(9666):</span>
<span class="c1">#       ISCs[subj1, subj2, vtx] = np.corrcoef(dm5[subj1, :, vtx], dm5[subj2, :, vtx])[0,1]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="calculate-iscs-for-searchlight-all-individual-pairs">
<h2>4. Calculate ISCs for searchlight, all individual pairs<a class="headerlink" href="#calculate-iscs-for-searchlight-all-individual-pairs" title="Link to this heading">#</a></h2>
<p>Letâ€™s calculate the intersubject correlation (ISC) for each searchlight, focusing on the brain activity of the vertices within each searchlight across time, rather than individual vertices across time. For this exercise, we will use ico8 searchlights with a radius of 15mm. The ico8 space provides a total of 607 searchlights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>607
</pre></div>
</div>
</div>
</div>
<section id="calculate-searchlight-means">
<h3>(1) Calculate searchlight means<a class="headerlink" href="#calculate-searchlight-means" title="Link to this heading">#</a></h3>
<p>However, before calculating ISC, we first need to compute the average activities of all vertices within each searchlight for each timeseries, as we focus on searchlights rather than individual vertices. <code class="docutils literal notranslate"><span class="pre">sl_means</span></code> will have the structure <code class="docutils literal notranslate"><span class="pre">[subject,</span> <span class="pre">timeseries,</span> <span class="pre">searchlight]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISCs, calculate ISCs of searchlight time-series</span>
<span class="c1">## calculate sl means</span>
<span class="n">sl_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">451</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">)):</span>
  <span class="n">sl_means</span><span class="p">[:,:,</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dm</span><span class="p">[:,:,</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">[</span><span class="n">sl</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sl_means</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 451, 607)
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-iscs">
<h3>(2) Calculate ISCs<a class="headerlink" href="#calculate-iscs" title="Link to this heading">#</a></h3>
<p>Letâ€™s see if the brain activity within each searchlight correlates across time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate coarse ISCs</span>
<span class="n">ISCs_ico8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">607</span><span class="p">))</span>
<span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">607</span><span class="p">):</span>
  <span class="n">ISCs_ico8</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sl_means</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">sl</span><span class="p">])</span>
  <span class="n">ISCs_ico8_clean</span> <span class="o">=</span> <span class="n">ISCs_ico8</span>
  <span class="n">ISCs_ico8_clean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ISCs_ico8</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 2</span>
<span class="c1">## calculate mean searchlight ISCs to show brain map</span>
<span class="n">ISCs_mean_ico8</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ISCs_ico8_clean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max ISC =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ISCs_mean_ico8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max ISC = 0.5857528193462688
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>(3) Plot brain image of ISCs<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plot mean pairwise ISCs</span>
<span class="n">lh8_minus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">603</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh8_minus_one</span><span class="p">,</span> <span class="n">ISCs_mean_ico8</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.58</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean pairwise searchlight ISCs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4bc9bd237f1742fecbc6efdd70a790771da3368381749d418d4a2c392af763f6.png" src="_images/4bc9bd237f1742fecbc6efdd70a790771da3368381749d418d4a2c392af763f6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lh8_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">603</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh8_zero</span><span class="p">,</span> <span class="n">ISCs_mean_ico8</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.58</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean pairwise searchlight ISCs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cc8a9c1b74b6c9dcffb5e43e68997cf38a6fb79c4394eca25eecd9d11d9ea3f0.png" src="_images/cc8a9c1b74b6c9dcffb5e43e68997cf38a6fb79c4394eca25eecd9d11d9ea3f0.png" />
</div>
</div>
</section>
</section>
<section id="compare-multisubject-dataset">
<h2>5. Compare multisubject dataset<a class="headerlink" href="#compare-multisubject-dataset" title="Link to this heading">#</a></h2>
<section id="compare-brain-activity-between-subjects-across-timeseries">
<h3>(1) Compare brain activity between subjects across timeseries<a class="headerlink" href="#compare-brain-activity-between-subjects-across-timeseries" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part II, ISC, cell 3 &amp; 4</span>
<span class="c1">## plot line graph of two vertex time-series from different brains</span>
<span class="c1">## FFA center vertex is 6579 in ico32 and 262 in ico8</span>
<span class="n">b1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">time_series1</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[</span><span class="n">b1</span><span class="p">,</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="mi">6579</span><span class="p">]</span>
<span class="n">time_series2</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[</span><span class="n">b2</span><span class="p">,</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="mi">6579</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_series1</span><span class="p">,</span> <span class="s2">&quot;r.-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_series2</span><span class="p">,</span> <span class="s2">&quot;g.-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;XXX&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;YYY&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;TTT&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;TTT&#39;)
</pre></div>
</div>
<img alt="_images/853842d06f65a5d57f4849677a20cb714ba3963378efb66f3b61d6c121673654.png" src="_images/853842d06f65a5d57f4849677a20cb714ba3963378efb66f3b61d6c121673654.png" />
</div>
</div>
</section>
<section id="compare-brain-activity-within-searchlight-between-subjects">
<h3>(2) Compare brain activity within searchlight between subjects<a class="headerlink" href="#compare-brain-activity-within-searchlight-between-subjects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 5</span>
<span class="c1">## plot scatter plot for ISC for one vertex with regression line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="n">b1</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">],</span> <span class="n">dm</span><span class="p">[</span><span class="n">b2</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">)</span>  <span class="c1"># make scatterplot</span>
<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="n">b1</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">],</span> <span class="n">dm</span><span class="p">[</span><span class="n">b2</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># calculate linear regression</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="n">b1</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">],</span> <span class="n">m</span><span class="o">*</span><span class="n">dm</span><span class="p">[</span><span class="n">b1</span><span class="p">,:,</span><span class="mi">6579</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># plot regression line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;subject 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;subject 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatterplot of correlation for FFA center vertex&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3acd60488d1ef9b2e29c2bc0ffe3082b22ad0d75d063dc0e928c2e6ef88b8b4a.png" src="_images/3acd60488d1ef9b2e29c2bc0ffe3082b22ad0d75d063dc0e928c2e6ef88b8b4a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ISCs_mean</span><span class="p">[</span><span class="mi">262</span><span class="p">]</span> <span class="c1"># should be ico8 vertice</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2151494342564746
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="tip-for-assignment-2-s-challenge">
<h2>ðŸ’¡ Tip for Assignment 2â€™s Challenge<a class="headerlink" href="#tip-for-assignment-2-s-challenge" title="Link to this heading">#</a></h2>
<p>One of the methods for calculating ISC that we covered in this tutorial involves calculating the correlation for all possible participant pairs and then averaging the results. <em>However</em>, there is another approach, where you calculate <strong>the correlation between each participant and the mean of all other participants excluding that individual.</strong></p>
<p>In the challenge section of Assignment 2, you are asked to compare the ISC results using this method with the two methods you just practiced in this tutorial: (1) ISCs using individual pairs (2) ISCs using searchlight means</p>
</section>
<section id="calculate-iscs-for-all-vertices-individuals-vs-others-means">
<h2>6. Calculate ISCs for all vertices, individuals vs others means<a class="headerlink" href="#calculate-iscs-for-all-vertices-individuals-vs-others-means" title="Link to this heading">#</a></h2>
<p>First, we will calculate the correlation of each individual subjectâ€™s data with the mean of all other participantsâ€™ data across time for all vertices. Since <code class="docutils literal notranslate"><span class="pre">dm</span></code> has the structure <code class="docutils literal notranslate"><span class="pre">[subj,</span> <span class="pre">timeseries,</span> <span class="pre">vertex]</span></code>, the data for a specific participant and vertex can be accessed using <code class="docutils literal notranslate"><span class="pre">dm[subj,</span> <span class="pre">:,</span> <span class="pre">vtx]</span></code>.</p>
<section id="generate-the-means-of-others">
<h3>(1) Generate the means of others<a class="headerlink" href="#generate-the-means-of-others" title="Link to this heading">#</a></h3>
<p>Now, letâ€™s create <code class="docutils literal notranslate"><span class="pre">dm_others</span></code>, which will store the mean of othersâ€™ data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm_others</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">451</span><span class="p">,</span><span class="mi">9666</span><span class="p">))</span>

<span class="k">for</span> <span class="n">subj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">dm_others</span><span class="p">[</span><span class="n">subj</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">dm</span><span class="p">[</span><span class="n">subj</span><span class="p">,:,:])</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>This will be compared with the same statistical method we used to calculate ISCs for all individual pairs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate ISCs between individual vs others mean,</span>
<span class="c1"># for all vertices across time</span>
<span class="n">ISCs_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">9666</span><span class="p">))</span>

<span class="k">for</span> <span class="n">subj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">vtx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9666</span><span class="p">):</span>
    <span class="n">ISCs_2</span><span class="p">[</span><span class="n">subj</span><span class="p">,</span> <span class="n">vtx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="n">subj</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vtx</span><span class="p">],</span> <span class="n">dm_others</span><span class="p">[</span><span class="n">subj</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vtx</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ISCs_2_clean</span> <span class="o">=</span> <span class="n">ISCs_2</span>
    <span class="n">ISCs_2_clean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ISCs_2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-mean-iscs-across-pairs">
<h3>(2) Calculate mean ISCs across pairs<a class="headerlink" href="#calculate-mean-iscs-across-pairs" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate means of ISCs across the pairs (individuals vs others mean) for all vertices</span>
<span class="n">ISCs_mean_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ISCs_2_clean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max ISC ind with other&#39;s mean =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ISCs_mean_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max ISC ind with other&#39;s mean = 0.7185225649703808
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>(3) Plot brain image of ISCs<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot with the same method</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">ISCs_mean_2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.71</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean ISCs between individuals and others means&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df0359517d80492d693fa0268ced1370f49ea3230610f6377470a3d31ee4a2db.png" src="_images/df0359517d80492d693fa0268ced1370f49ea3230610f6377470a3d31ee4a2db.png" />
</div>
</div>
</section>
</section>
<section id="calculate-differences-between-iscs">
<h2>7. Calculate differences between ISCs<a class="headerlink" href="#calculate-differences-between-iscs" title="Link to this heading">#</a></h2>
<section id="all-individual-pairs-individual-vs-others-mean-pairs">
<h3>(1) All individual pairs - Individual vs others mean pairs<a class="headerlink" href="#all-individual-pairs-individual-vs-others-mean-pairs" title="Link to this heading">#</a></h3>
<p>As ISCs between all individual pairs have the same resolution as the ISCs between individuals and the mean of others, we can simply subtract one from the other like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ISCs_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ISCs_mean_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9666,) (9666,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ISCs_mean_2</span><span class="o">-</span><span class="n">ISCs_mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3333333333333333
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">ISCs_mean_2</span><span class="o">-</span><span class="n">ISCs_mean</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Difference between ISCs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d6adb8554d1aacbe4301bcf174cd2e05fe416ba1421c7d0419acb141b1459678.png" src="_images/d6adb8554d1aacbe4301bcf174cd2e05fe416ba1421c7d0419acb141b1459678.png" />
</div>
</div>
</section>
<section id="all-vertices-searchlight">
<h3>(2) All vertices - Searchlight<a class="headerlink" href="#all-vertices-searchlight" title="Link to this heading">#</a></h3>
<p>The searchlight analysis, with ico8 resolution, consists of 607 data points. To compare high-resolution data with this, we need to select the vertices corresponding to the centers of the 607 searchlights from the 9666 data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ISCs_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ISCs_mean_ico8</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9666,) (607,)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SLS_ico8_15mm_rh</span></code> contains all the vertices within each searchlight. For each searchlight, the index [0] represents the vertex that is located at the center of the searchlight. We can save the vertex of each searchlightâ€™s center to <code class="docutils literal notranslate"><span class="pre">hires_centers</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>607
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hires_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">607</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">607</span><span class="p">):</span>
  <span class="n">hires_centers</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">SLS_ico8_15mm_rh</span><span class="p">[</span><span class="n">sl</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now, using the vertex corresponding to each searchlight center <code class="docutils literal notranslate"><span class="pre">np.int_(hires_centers[sl])</span></code>, we can store a subset of the data from <code class="docutils literal notranslate"><span class="pre">ISCs_mean</span></code> into <code class="docutils literal notranslate"><span class="pre">ISCs_hi_to_lo</span></code> for the 607 data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ISCs_hi_to_lo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">607</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">607</span><span class="p">):</span>
  <span class="n">ISCs_hi_to_lo</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">ISCs_mean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">(</span><span class="n">hires_centers</span><span class="p">[</span><span class="n">sl</span><span class="p">])]</span>
  <span class="c1">#ISCs_clean[:,:,hires_centers[sl]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="n">ISCs_mean_ico8</span><span class="o">-</span><span class="n">ISCs_hi_to_lo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5143247716699202
</pre></div>
</div>
</div>
</div>
<p>As a result, <code class="docutils literal notranslate"><span class="pre">ISCs_hi_to_lo</span></code> will have the same resolution as <code class="docutils literal notranslate"><span class="pre">ISCs_mean_ico8</span></code>, allowing for easy comparison and plotting through a simple subtraction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh8_minus_one</span><span class="p">,</span> <span class="n">ISCs_mean_ico8</span><span class="o">-</span><span class="n">ISCs_hi_to_lo</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.51</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Difference between ISCs (ico8)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01e88b35f3cddeb3f38873265c57380fb9ce147e93b9d73a94f1e1778ddec8e8.png" src="_images/01e88b35f3cddeb3f38873265c57380fb9ce147e93b9d73a94f1e1778ddec8e8.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1_data_visualization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>1. Data Visualization</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="3_functional_connectivity.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>3. ISC Analysis of Functional Connectivity</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-environment-import-libraries-and-load-searchlight-indices">1. Setup environment, import libraries, and load searchlight indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-a-multi-subject-dataset">2. Load a multi-subject dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-isc-for-all-vertices-all-individual-pairs">3. Calculate ISC for all vertices, all individual pairs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset">(1) Load dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mean-isc-across-pairs">(2) Calculate mean ISC across pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-brain-image-of-iscs">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs-for-searchlight-all-individual-pairs">4. Calculate ISCs for searchlight, all individual pairs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-searchlight-means">(1) Calculate searchlight means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs">(2) Calculate ISCs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-multisubject-dataset">5. Compare multisubject dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-brain-activity-between-subjects-across-timeseries">(1) Compare brain activity between subjects across timeseries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-brain-activity-within-searchlight-between-subjects">(2) Compare brain activity within searchlight between subjects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-for-assignment-2-s-challenge">ðŸ’¡ Tip for Assignment 2â€™s Challenge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-iscs-for-all-vertices-individuals-vs-others-means">6. Calculate ISCs for all vertices, individuals vs others means</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-the-means-of-others">(1) Generate the means of others</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mean-iscs-across-pairs">(2) Calculate mean ISCs across pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">(3) Plot brain image of ISCs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-differences-between-iscs">7. Calculate differences between ISCs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-individual-pairs-individual-vs-others-mean-pairs">(1) All individual pairs - Individual vs others mean pairs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-vertices-searchlight">(2) All vertices - Searchlight</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eunhye Choe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>