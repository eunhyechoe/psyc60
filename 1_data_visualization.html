
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Data Visualization &#8212; PSYC60 Lab Exercises (F24)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1_data_visualization';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Intersubject Correlation (ISC) Analysis" href="2_ISC.html" />
    <link rel="prev" title="PSYC60 Lab Exercise" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_psyc60.png" class="logo__image only-light" alt="PSYC60 Lab Exercises (F24) - Home"/>
    <script>document.write(`<img src="_static/logo_psyc60.png" class="logo__image only-dark" alt="PSYC60 Lab Exercises (F24) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    PSYC60 Lab Exercise
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>1. Data Visualization</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="2_ISC.html"><strong>2. Intersubject Correlation (ISC) Analysis</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="3_functional_connectivity.html"><strong>3. ISC Analysis of Functional Connectivity</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="4_simple_contrasts.html"><strong>4. Simple Contrasts for Localizer Data</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="5_RSA_localizer.html"><strong>5. Representational Similarity Analysis (RSA)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="6_RSA_movie.html"><strong>6. ISC of Representational Geometry</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eunhyechoe/psyc60" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eunhyechoe/psyc60/issues/new?title=Issue%20on%20page%20%2F1_data_visualization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/1_data_visualization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. Data Visualization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-environment-for-colab">1. Setup environment for Colab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">2. Import Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-dataset">3. Define dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">4. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">5. Plot Time-series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-response-pattern">6. Plot Response Pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-searchlight-indices">7. Import searchlight indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-responses-in-one-searchlight">8. Plot Responses in One Searchlight</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcional-connectivity">9. Funcional Connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-plot">10. Functional Connectivity Plot</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/eunhyechoe/psyc60/blob/main/1_data_visualization.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="data-visualization">
<h1><strong>1. Data Visualization</strong><a class="headerlink" href="#data-visualization" title="Link to this heading">#</a></h1>
<p>Plot time-series, response patterns, and functional connectivity profiles</p>
<p><em>Lastly Updated: Sep 28, 2024 (8:58 PM)</em></p>
<section id="setup-environment-for-colab">
<h2>1. Setup environment for Colab<a class="headerlink" href="#setup-environment-for-colab" title="Link to this heading">#</a></h2>
<p>Colab’s virtual environment is temporary, so you need to install any non-default packages each time you run the script. Run the following cell first to set up the environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 1</span>
<span class="c1"># Install the neuroboros package</span>
<span class="c1"># The &#39;%%capture&#39; is used to suppress the output in this webpage</span>
<span class="o">%%capture</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">neuroboros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%%capture` not found.
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-libraries">
<h2>2. Import Libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h2>
<p>Colab comes with pre-installed packages like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, so you can import them without installation. We also import <code class="docutils literal notranslate"><span class="pre">neuroboros</span></code> under the simplified alias <code class="docutils literal notranslate"><span class="pre">nb</span></code> for convenience.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 2</span>
<span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="kn">import</span> <span class="nn">neuroboros</span> <span class="k">as</span> <span class="nn">nb</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-dataset">
<h2>3. Define dataset<a class="headerlink" href="#define-dataset" title="Link to this heading">#</a></h2>
<p>We will load the <a class="reference external" href="https://www.studyforrest.org/">StudyForrest</a> data in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> format using the <code class="docutils literal notranslate"><span class="pre">neuroboros</span></code> package. For detailed explanations of the code, refer to the <a class="reference external" href="https://neuroboros.github.io/tutorials/neuroimaging_data_matrix.html">Neuroboros</a> tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 3</span>
<span class="c1"># define dataset</span>
<span class="c1"># &#39;sids&#39; contains the subject IDs of participants in the dataset</span>
<span class="n">dset</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">Forrest</span><span class="p">()</span> <span class="c1"># Load the Forrest dataset</span>
<span class="n">sids</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">subjects</span> <span class="c1"># Get all subject IDs</span>
<span class="nb">type</span><span class="p">(</span><span class="n">sids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">sids</span><span class="p">)</span> <span class="c1"># Check the type and number of subject IDs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(list, 15)
</pre></div>
</div>
</div>
</div>
<p>Python uses zero-based indexing, meaning it starts counting from 0, not 1.</p>
<p>To get the subject IDs of the first three participants, use <code class="docutils literal notranslate"><span class="pre">sids[0:3]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;01&#39;, &#39;02&#39;, &#39;03&#39;]
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sids[:3]</span></code> gives the same result by loading the first three subject IDs from the top of the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;01&#39;, &#39;02&#39;, &#39;03&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-data">
<h2>4. Load the data<a class="headerlink" href="#load-the-data" title="Link to this heading">#</a></h2>
<p>We will set the first subject ID of the list to <code class="docutils literal notranslate"><span class="pre">sid</span></code>, and get the data as <code class="docutils literal notranslate"><span class="pre">dm</span></code> for the following parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 4</span>
<span class="c1"># Upload right hemisphere data for one subject (subject ID is sid[0]) for a specific run</span>
<span class="n">sid</span> <span class="o">=</span> <span class="n">sids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># choose the first subject data</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s1">&#39;forrest&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1"># command structure: get_data(subject id, &#39;dataset&#39;, run number, &#39;hemisphere&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dm</span><span class="p">),</span> <span class="n">dm</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt; float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(451, 9666)
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-time-series">
<h2>5. Plot Time-series<a class="headerlink" href="#plot-time-series" title="Link to this heading">#</a></h2>
<p>Each row of the data represents time points (TR = 0 to 450), and the columns correspond to cortical vertices (9675 in total). You can plot a response time series (TR) for a cortical vertex (vertex #).</p>
<p>Here, we will plot one for the first vertex index (vertex [0]), from TR 100 to TR 200.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 5</span>
<span class="c1"># Plot the time series data for a specific cortical vertex, for example, FFA</span>
<span class="c1">## FFA center vertex is identified as 6579 in ico32 resolution</span>
<span class="n">time_series1</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="mi">6579</span><span class="p">]</span> <span class="c1"># Extract data for time-points 100 to 200 for vertex 6579</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_series1</span><span class="p">,</span> <span class="s2">&quot;b.-&quot;</span><span class="p">)</span> <span class="c1"># Plot the time series with blue dots and lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time-point (TR=2s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;MR signal (normalized)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;FFA center vertex&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FFA center vertex&#39;)
</pre></div>
</div>
<img alt="_images/0381256d498f2a11a8430880ae60de6ac1203f2e3bd52fcfd84d1a80d61ba569.png" src="_images/0381256d498f2a11a8430880ae60de6ac1203f2e3bd52fcfd84d1a80d61ba569.png" />
</div>
</div>
</section>
<section id="plot-response-pattern">
<h2>6. Plot Response Pattern<a class="headerlink" href="#plot-response-pattern" title="Link to this heading">#</a></h2>
<p>You can also check the spatial response pattern for a specific time point, for example, TR = 47.</p>
<p>Let’s start with the whole brain pattern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 6</span>
<span class="c1"># Plot an image of the responses at a specific time point (TR = 47)</span>

<span class="c1"># Create blank arrays with the appropriate number of vertices for left and right hemispheres</span>
<span class="n">lh_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9675</span><span class="p">))</span>  <span class="c1"># For left hemisphere vertices</span>
<span class="n">rh_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9666</span><span class="p">))</span>  <span class="c1"># For right hemisphere vertices</span>
<span class="n">lh_minus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9675</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Initialize left hemisphere with -1 for a blue background</span>
<span class="n">rh_minus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9666</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Initialize right hemisphere with -1 for a blue background</span>

<span class="c1"># Plot an image of the response at TR = 47 for the right hemisphere (vertex data from dm)</span>
<span class="c1"># with a blank array for left hemisphere (lh_misus_one)</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">dm</span><span class="p">[</span><span class="mi">47</span><span class="p">,</span> <span class="p">:]],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Response pattern&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3a29f6e8dd9c9eac10f709609f13c5e4e2d32c2d42b073f3137969f2c3238da.png" src="_images/d3a29f6e8dd9c9eac10f709609f13c5e4e2d32c2d42b073f3137969f2c3238da.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">plot</span></code> command in <code class="docutils literal notranslate"><span class="pre">neuroboros</span></code> allows for different color scales available for <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<p>Let’s try one of color-blind friendly colormaps, <code class="docutils literal notranslate"><span class="pre">magma</span></code>. (Check out <a class="reference external" href="https://matplotlib.org/stable/users/explain/colors/colormaps.html#overview">this</a> for more options.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">dm</span><span class="p">[</span><span class="mi">47</span><span class="p">,:]],</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Response pattern&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2cb969c3ddb8728734bd40527d25b763d0b1dcf56b04523937cfdf1314bad1b5.png" src="_images/2cb969c3ddb8728734bd40527d25b763d0b1dcf56b04523937cfdf1314bad1b5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can also load the left hemisphere data and plot both hemispheres (but it takes time)</span>
<span class="c1"># nb.plot([dset.get_data(sid, &#39;forrest&#39;, 1, &#39;l&#39;)[47,:], dm[47,:]],</span>
<span class="c1">#      cmap=&#39;bwr&#39;, vmax=4, vmin=-4, title=&#39;Response pattern&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-searchlight-indices">
<h2>7. Import searchlight indices<a class="headerlink" href="#import-searchlight-indices" title="Link to this heading">#</a></h2>
<p>The brain has a complex 3D structure. This can be simplified by representing its surface as a mesh of small triangles. Using the <code class="docutils literal notranslate"><span class="pre">nb.sls</span></code> function, you can extract coordinates from a spherical region on this surface mesh.</p>
<p><code class="docutils literal notranslate"><span class="pre">nb.sls</span></code> returns the vertex indices for each searchlight as a list of <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays. In this step, you will focus on the right hemisphere with a 20 mm radius, using the <code class="docutils literal notranslate"><span class="pre">onavg</span></code> (OpenNeuro Average) template at ico8 resolution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 7</span>
<span class="c1"># Import searchlight indices for the right hemisphere (ico8 resolution)</span>
<span class="c1">## searchlight radius = 10, 15, and 20 mm (right hemisphere)</span>
<span class="n">SLS_ico8_10mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SLS_ico8_15mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SLS_ico8_20mm_rh</span><span class="p">,</span> <span class="n">Dists_ico8_20mm_rh</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">sls</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;onavg-ico32&#39;</span><span class="p">,</span> <span class="n">center_space</span><span class="o">=</span><span class="s1">&#39;onavg-ico8&#39;</span><span class="p">,</span> <span class="n">return_dists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># command structure: nb.sls(&#39;hemisphere&#39;, radius, vertex apace, center space, option to load file of distances from center to each vertex)</span>
<span class="c1"># - &#39;r&#39;: Right hemisphere</span>
<span class="c1"># - radius: Searchlight radius in mm</span>
<span class="c1"># - space: Vertex space for searchlight calculations (onavg-ico32 in this case)</span>
<span class="c1"># - center_space: Resolution of the searchlight center vertices (onavg-ico8)</span>
<span class="c1"># - return_dists: Whether to return distances between vertices in the searchlight</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_10mm_rh</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_15mm_rh</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>607 607 607
</pre></div>
</div>
</div>
</div>
<p>We start by extracting the vertex indices for each searchlight. The <code class="docutils literal notranslate"><span class="pre">nb.sls</span></code> function defines the centers of these searchlights based on the low resolution <code class="docutils literal notranslate"><span class="pre">ico8</span></code> space, resulting in 607 vertices that serve as searchlight centers. Then, leveraging the high resolution ico32 space, we identify the vertices within a specified radius around each center, in this case, 10 mm.</p>
<p>Although all the searchlights share the same 607 centers, the number of vertices within each searchlight varies depending on the radius. You can verify this by checking the length of the output arrays as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># vertex 0&#39;s searchlight in 10 mm radius</span>
<span class="n">SLS_ico8_10mm_rh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2525, 2288, 1652, 3359,  612, 2702, 9038,  834, 5731, 3319, 1204,
       9134, 7832, 3580, 7226, 6084, 6216, 6463,  559, 3358, 2458, 8225,
       9526, 6386, 8083, 6425, 9562])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># vertex 0&#39;s searchlight in 15 mm radius</span>
<span class="n">SLS_ico8_15mm_rh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2525, 2288, 1652, 3359,  612, 2702, 9038,  834, 5731, 3319, 1204,
       9134, 7832, 3580, 7226, 6084, 6216, 6463,  559, 3358, 2458, 8225,
       9526, 6386, 8083, 6425, 9562,  543, 1496, 3221, 4587, 8871, 2832,
        261, 1199, 4456, 2622,  457, 2580, 4717, 2094,  477, 5238, 6443,
       3809, 8748, 5673,  951,  632, 3115, 6588, 6449, 5239, 4947, 2763,
       8649, 5864, 1084, 7738, 7697, 3902, 1896, 7597, 7803, 8342])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># vertex 0&#39;s searchlight in 20 mm radius</span>
<span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2525, 2288, 1652, 3359,  612, 2702, 9038,  834, 5731, 3319, 1204,
       9134, 7832, 3580, 7226, 6084, 6216, 6463,  559, 3358, 2458, 8225,
       9526, 6386, 8083, 6425, 9562,  543, 1496, 3221, 4587, 8871, 2832,
        261, 1199, 4456, 2622,  457, 2580, 4717, 2094,  477, 5238, 6443,
       3809, 8748, 5673,  951,  632, 3115, 6588, 6449, 5239, 4947, 2763,
       8649, 5864, 1084, 7738, 7697, 3902, 1896, 7597, 7803, 8342, 4031,
       3755, 2816, 5293, 3266, 8072, 8900, 4980, 4062, 1135, 6240, 1643,
       7081, 3043, 4278,  828, 5368, 6082, 4089, 7420, 9470, 2402, 5182,
       7804, 1875,  847, 2829, 2605, 8192, 7133, 6826, 3837, 1289, 7688,
       1870, 3638,  931, 2501,  734, 6857, 3608, 6460, 1285, 5462, 6866,
       7732, 4137, 8624, 4448, 8875, 7433, 5081, 2203, 6698, 7878])
</pre></div>
</div>
</div>
</div>
<p>If you set <code class="docutils literal notranslate"><span class="pre">return_dists=True</span></code>, you can check the distance from each vertex to the center of the searchlight.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dists_ico8_20mm_rh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.48304748,  2.61258366,  3.10141759,  3.79217634,  4.28802939,
        4.66836696,  5.00587528,  5.06798309,  5.78989275,  6.0200985 ,
        6.30125702,  6.52689231,  7.13159626,  7.22800534,  7.6159596 ,
        7.7545429 ,  7.82747705,  7.89624676,  8.30505792,  8.9456715 ,
        9.01621693,  9.01687952,  9.06264802,  9.30359958,  9.34427125,
        9.39392963,  9.70150306, 10.09029469, 10.09837002, 10.09868217,
       10.46477979, 10.61984395, 10.68497179, 10.79628171, 10.9601238 ,
       11.26284889, 11.29768772, 11.66229336, 11.77852963, 11.8703167 ,
       11.89513777, 11.99629971, 12.25345858, 12.32949468, 12.35896225,
       12.50638884, 12.6020951 , 12.64712111, 13.02348511, 13.51964008,
       13.57076944, 13.57143343, 13.63020304, 13.63695249, 13.72485909,
       13.92477888, 14.04287915, 14.05583613, 14.07672766, 14.11625699,
       14.25560668, 14.33358632, 14.35914417, 14.44420532, 14.98008685,
       15.02910766, 15.17206928, 15.35882542, 15.38019842, 15.41678212,
       15.56264561, 15.60827004, 15.93500642, 15.99880191, 16.03996074,
       16.13641075, 16.18845042, 16.20819415, 16.21000203, 16.25394856,
       16.55675145, 16.71140844, 16.76406281, 16.83322868, 16.8870039 ,
       16.97322909, 17.14355184, 17.14590548, 17.16028315, 17.19953454,
       17.31580491, 17.40708678, 17.43395752, 17.67912319, 17.83795057,
       17.9179102 , 17.92651634, 18.05953252, 18.14342538, 18.18542784,
       18.23677785, 18.55376226, 18.65870797, 18.66556721, 18.75931254,
       18.79281506, 18.84239792, 18.87592351, 19.03508959, 19.08211436,
       19.18287115, 19.23003331, 19.51686375, 19.54191068, 19.57640243,
       19.6471922 , 19.66281053, 19.6873662 , 19.73578271, 19.9531177 ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-responses-in-one-searchlight">
<h2>8. Plot Responses in One Searchlight<a class="headerlink" href="#plot-responses-in-one-searchlight" title="Link to this heading">#</a></h2>
<p>We can plot response patterns for one ico8 searchlight (index 262 for FFA).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(list, 607)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="mi">262</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="mi">262</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(numpy.ndarray, 125)
</pre></div>
</div>
</div>
</div>
<p>The ico8 searchlight for right FFA (radius = 20 mm) has 125 vertex indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="mi">262</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([6579, 5046, 2891, 2069, 4324, 2188, 7195, 2597, 4337, 4872,  406,
       9215, 4559, 6360, 4141, 1662, 9048, 6314, 5789, 2874, 1635, 6850,
       2691, 2884, 7741, 7662, 1879, 6519,  755, 8054, 5313, 5010, 2947,
       9250, 9465, 2930, 3209, 3371, 6942, 8482, 4354, 1438, 2228, 8246,
       8654, 8879, 8722, 5564, 8753, 3417, 5341, 5934, 1150, 1794, 3924,
       6110, 7088, 1703, 1806,  750, 8768, 2759, 1612, 9227, 3872, 4282,
       5170, 4059, 7942, 7148, 6168, 2954, 5979, 5272, 7584, 6121, 3794,
       4225, 3600,  193, 4474, 2628, 5811, 5224, 1190,  351, 1024, 6975,
       7836, 3085, 6321, 1291, 3606, 6212, 3219,  181, 4247, 8163, 1494,
       7824,  264, 7772, 8511, 1501, 4163, 7723, 1081, 4968, 6925, 2630,
       4911, 3643,  437, 9423, 6921, 3031, 8299, 2560, 4914, 8617, 7491,
       9200, 7353, 6593,    8])
</pre></div>
</div>
</div>
</div>
<p>We can extract the data for the right FFA searchlight.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sl_dm</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[:,</span> <span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="mi">262</span><span class="p">]]</span>
<span class="n">sl_dm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(451, 125)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 8</span>
<span class="c1"># plot responses in one searchlight (right FFA) for time-point 47</span>
<span class="n">sl</span> <span class="o">=</span> <span class="mi">262</span>  <span class="c1"># Searchlight index for the right FFA (corresponds to vertex 262 in ico8 resolution)</span>
<span class="n">tp</span> <span class="o">=</span> <span class="mi">47</span>  <span class="c1"># Time-point to visualize (TR = 47)</span>

<span class="c1"># Create a background for right hemisphere data (will be blue background for our searchlight data)</span>
<span class="n">rh_minus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">9666</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span> <span class="c1"># Initialize right hemisphere data to -1 (blue background)</span>
<span class="n">rh_sl</span> <span class="o">=</span> <span class="n">rh_minus_one</span> <span class="c1"># Copy this to rh_sl, which will be updated with actual data below</span>

<span class="c1"># Loop through all vertices within the searchlight (using ico8 resolution with a 20mm radius)</span>
<span class="c1"># The searchlight index &quot;sl&quot; (262) corresponds to the right FFA, and we extract the vertices in its searchlight</span>
<span class="k">for</span> <span class="n">vtx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="n">sl</span><span class="p">])):</span>
  <span class="n">rh_sl</span><span class="p">[</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="n">sl</span><span class="p">][</span><span class="n">vtx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[</span><span class="n">tp</span><span class="p">,</span><span class="n">SLS_ico8_20mm_rh</span><span class="p">[</span><span class="n">sl</span><span class="p">][</span><span class="n">vtx</span><span class="p">]]</span> <span class="c1"># Copy actual data from dm to rh_sl for plotting</span>

<span class="c1"># Plot the updated right hemisphere data with the searchlight values</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">rh_sl</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Response pattern&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8d597fae9ce6e12d131a32a067f0436ba91959d3d07e5c71dbea82d5c5f52ac2.png" src="_images/8d597fae9ce6e12d131a32a067f0436ba91959d3d07e5c71dbea82d5c5f52ac2.png" />
</div>
</div>
</section>
<section id="funcional-connectivity">
<h2>9. Funcional Connectivity<a class="headerlink" href="#funcional-connectivity" title="Link to this heading">#</a></h2>
<p>To visualize areas that are functionally connected to the right FFA based on similarity, we first calculate the average activity of the data points within the right FFA searchlight for each time point. Then, we measure how much this activity correlates (i.e., covaries over time) with other data points across the brain.</p>
<p>To calculate connectivity vectors across the time series, we will begin by computing the mean activity for each time frame within the target searchlight.</p>
<p>The data matrix dm is structured such that the rows represent time points and the columns represent cortical vertices (<code class="docutils literal notranslate"><span class="pre">dm(time_series,</span> <span class="pre">vertex)</span></code>). In this step, we filter the data to focus on the vertices within a defined searchlight using <code class="docutils literal notranslate"><span class="pre">SLS_ico8_10mm_rh[target_searchlight_vertex]</span></code>.</p>
<p>For example, the vertex for the right pFFA in ico8 space is 262 (and 467 for the right pSTS). We can obtain the mean brain activity for each time point within the searchlight of the right pFFA (or right pSTS) using the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 9</span>
<span class="c1"># Calculate functional connectivity vectors for two target regions: pFFA (~vertex 262) and pSTS (~vertex 467)</span>

<span class="c1"># Calculate the mean time series for the 10mm radius searchlights</span>
<span class="n">mean_ffa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dm</span><span class="p">[:,</span> <span class="n">SLS_ico8_10mm_rh</span><span class="p">[</span><span class="mi">262</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Mean time series for pFFA (vertex 262)</span>
<span class="n">mean_sts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dm</span><span class="p">[:,</span> <span class="n">SLS_ico8_10mm_rh</span><span class="p">[</span><span class="mi">467</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Mean time series for pSTS (vertex 467)</span>

<span class="c1"># calculate connectivity vectors</span>
<span class="n">connvec_ffa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">mean_ffa</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">connvec_sts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">mean_sts</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/usr/local/lib/python3.10/dist-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
</pre></div>
</div>
</div>
</div>
<p>We also calculated the functional connectivity vectors by correlating the average time series of the target region (either the pFFA or pSTS) with the time series of all other vertices in the brain. This was done using Pearson correlation across the time series.</p>
<p>For example, connvec_ffa stores the correlation coefficients (using <code class="docutils literal notranslate"><span class="pre">np.corrcoef</span></code>) between the average time series of the right pFFA and the time series of all other vertices. These coefficients indicate the degree of functional connectivity between the right pFFA and other regions of the brain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">connvec_ffa</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">connvec_sts</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9666,) (9666,)
</pre></div>
</div>
</div>
</div>
<p>The 9666 data points, which correspond to all the vertices in the right hemisphere, now each have a correlation coefficient representing how strongly their activity is correlated with the activity within the searchlight for either the right pFFA or pSTS.</p>
</section>
<section id="functional-connectivity-plot">
<h2>10. Functional Connectivity Plot<a class="headerlink" href="#functional-connectivity-plot" title="Link to this heading">#</a></h2>
<p>You can also plot these connectivity patterns, which consist of correlation coefficients for each vertex. These values show how brain activity correlates between each brain region and the target searchlight area (e.g., pFFA or pSTS) across time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cell 10</span>
<span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">connvec_ffa</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;pFFA connectivity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/332b780e700bc3470808caf9e0f8a707c9d0cbc025cb51a21e2e91343fccd611.png" src="_images/332b780e700bc3470808caf9e0f8a707c9d0cbc025cb51a21e2e91343fccd611.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lh_minus_one</span><span class="p">,</span> <span class="n">connvec_sts</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;PRGn&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;pSTS connectivity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3f6086e2c1f79001fdb6cfb94ffb2cbf0a551900f82e5f93c263bafce25df51.png" src="_images/d3f6086e2c1f79001fdb6cfb94ffb2cbf0a551900f82e5f93c263bafce25df51.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PSYC60 Lab Exercise</p>
      </div>
    </a>
    <a class="right-next"
       href="2_ISC.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>2. Intersubject Correlation (ISC) Analysis</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-environment-for-colab">1. Setup environment for Colab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">2. Import Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-dataset">3. Define dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">4. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">5. Plot Time-series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-response-pattern">6. Plot Response Pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-searchlight-indices">7. Import searchlight indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-responses-in-one-searchlight">8. Plot Responses in One Searchlight</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcional-connectivity">9. Funcional Connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-plot">10. Functional Connectivity Plot</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eunhye Choe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>